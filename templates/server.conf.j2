# {{ ansible_managed }}
# DO NOT EDIT
daemon openvpn-server
syslog openvpn-server
log /var/log/openvpn/server.log

dev tun0
proto udp
port 1194

topology subnet
server {{ openvpn_subnet }} {{ openvpn_submask }}
ifconfig-pool-persist pool.txt

ca /etc/ssl/openvpn/ca.crt
dh /etc/ssl/openvpn/dh4096.pem
cert /etc/ssl/openvpn/server.crt
key /etc/ssl/openvpn/server.key

script-security 3

client-cert-not-required
username-as-common-name
client-config-dir ccd
{%- if openvpn_auth == 'script' -%}
# authenticate based on local openvpn password file
auth-user-pass-verify /etc/openvpn/bin/authenticate.sh via-env
{%- else -%}
# authenticate via PAM
plugin /usr/share/openvpn/plugin/lib/openvpn-auth-pam.so {{ openvpn_pam_file }}
{%- endif -%}

auth SHA256
cipher AES-256-CBC
keysize 256
tls-cipher TLS-DHE-RSA-WITH-AES-256-CBC-SHA256

keepalive 10 30

mlock
fast-io
persist-tun

status /var/log/openvpn/status-server.log

comp-lzo
verb 3
mute 20

sndbuf 0
rcvbuf 0
push "rcvbuf 262144"
push "redirect-gateway def1 bypass-dhcp"
push "route {{ openvpn_route }} {{ openvpn_route_submask }}"
